<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Address Book</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="topnav">
    <a href="index.html">Add New Records</a>
    <a class="active" href="list.html">List of Records</a>
    <a href="search.html">Search Page</a>
</div>

    <div class="container" id="main_container">
        <h1>Current records</h1>
        <div id="error_page">
            <p></p>
        </div>
        <div id="head_grid" class="grid-container">
            <span>#</span>
            <div class="head-title">
                <span>Name</span>
            </div>
            <div class="head-title">
                <span>Phone Number</span>
            </div>
        </div>

        <div id="blank_container" class="grid-container im-not-visible">
            <span class="index"></span>
            <div class="input-container">
                <span class="record-name"></span>
            </div>
            <div class="input-container">
                <span class="record-phone"></span>
            </div>
        </div>
    </div>

    <script>

        (function() {
            let arrayOfNames = [];
            if (localStorage.getItem("names")){
                arrayOfNames = JSON.parse(localStorage.getItem("names"));
            }

            let arrayOfPhones = [];
            if (localStorage.getItem("phones")){
                arrayOfPhones = JSON.parse(localStorage.getItem("phones"));
            }

            const errorPage = document.getElementById("error_page");
            if(arrayOfNames.length !== arrayOfPhones.length){
                errorPage.children[0].textContent = "There is something wrong with the list of records";
                errorPage.classList.add("im-visible");
                document.getElementById("head_grid").remove();
                return false;
            }
            if(arrayOfNames.length === 0){
                errorPage.children[0].textContent = "There are no records created";
                errorPage.classList.add("im-visible");
                document.getElementById("head_grid").remove();
            }else{
                const target = document.getElementById("main_container");
                const node = document.getElementById("blank_container");

                let list = [];
                for (var x = 0; x < arrayOfNames.length; x++){ 
                    list.push({'name': arrayOfNames[x], 'phone': arrayOfPhones[x]});
                }

                list.sort((a, b) => a.name.toLowerCase().localeCompare(b.name.toLowerCase()));

                list.map((item,x) => {
                    const newNode = node.cloneNode(true);
                    newNode.classList.remove("im-not-visible");
                    newNode.removeAttribute('id');
                    newNode.getElementsByClassName("index")[0].textContent = `${(x+1)}. `;
                    newNode.getElementsByClassName("record-name")[0].textContent = item.name;
                    newNode.getElementsByClassName("record-phone")[0].textContent = item.phone;
                    target.appendChild(newNode);
                });
                node.remove();
            }
        }());

    </script>
</body>
</html>
